apiVersion: batch/v1
kind: Job
metadata:
  name: sparker-alt
  namespace: tbd
spec:
  ttlSecondsAfterFinished: 300
  backoffLimit: 1
  parallelism: 1
  completions: 1
  template:
    spec:
      containers:
        - name: sparker-alt
          image: docker.pkg.github.com/navikt/helse-sparker-alt/helse-sparker-alt:d4b4ec0
          resources:
            requests:
              memory: 256Mi
              cpu: 100m
            limits:
              memory: 512Mi
              cpu: 1000m
          volumeMounts:
            - mountPath: /var/run/secrets/nais.io/vault
              name: vault-secrets
              subPath: subpath/var/run/secrets/nais.io/vault
            - mountPath: /var/run/secrets/nais.io/kafka
              name: kafka-credentials
              readOnly: true
          env:
            - name: VAULT_TOKEN_PATH
              value: /var/run/secrets/nais.io/vault/vault_token
            - name: KAFKA_TARGET_TOPIC
              value: tbd.rapid.v1
            - name: DATABASE_NAME
              value: spare
            - name: DATABASE_JDBC_URL
              value: "jdbc:postgresql://a01dbvl027.adeo.no:5432/spare"
            - name: ANTALL
              value: "100"
            - name: ANTALL_SKIPPED
              value: "0"
            - name: ENKELTPERSONER
              value: "13078536645:1000038024996,11086047472:1000033763521,13039444482:1000037287719,13045647972:1000037401128,11117827854:1000026055356,12059248837:1000035478598,01037126671:1000010899974,13106145479:1000038507955,02068549240:1000013783691,01037942622:1000010919184,02077425678:1000013943549,03047833158:1000015573544,02076740308:1000013929652,02098036388:1000014309442,03018329424:1000092534093,03017732616:1000015004369,03056628273:1000015745024,03019228648:1000015034852,04118338923:1000019056083,03065630264:1000015918628,03017226842:1000008415956,04037748973:1000017569969,04068932837:1000018178507,03108642644:1000016711137,04127442865:1000019205866,04047743481:1000017769653,04099044840:1000018718456,04097943635:1000018696405,03090283552:1000084188063,04119138839:1000019071931,04068745905:1000018175098,04087949244:1000018522363,03097740274:1000016502599,05056238745:1000020120183,05018634793:1000008728399,05046133686:1000019918781,05089149020:1000020733013,04068944800:1000018179543,05098142942:1000020888338,06039026692:1000021966765,05125842145:1000021355831,06017843581:1000021572453,04128344883:1000019220316,05046038470:1000019916914,06039132301:1000021970062,06077128547:1000022701653,04126140016:1000019180333,05116532672:1000021207448,06069339482:1000022566369,06067433414:1000022524311,06028535838:1000021765867,07067343314:1000024694969,07017432286:1000023750713,06069749680:1000022578498,06118648674:1000023436586,06106535920:1000023228058,06088739165:1000022913861,06056638081:1000022313429,07077742241:1000024886014,07076125915:1000024850645,07048039299:1000002056246,06127748819:1000023586136,07078549054:1000024902051,08089348286:1000027264398,08078038242:1000027055096,08026937591:1000026086351,07118743657:1000025604152,07029335944:1000023967319,08129749556:1000027958611,08069523154:1000026908215,09096234497:1000029538035,09078243209:1000029224424,08108847205:1000027606822,09108346032:1000029757171,09097838361:1000029569993,09027345414:1000028261146,10028143600:1000004739552,10017230927:1000002421235,09059148637:1000028879734,08085929209:1000006223109,10117949600:1000006390858,09038833615:1000028478089,09056749532:1000028826517,09110093516:1000029800203,09035941794:1000028416656,09086838343:1000029373101,08109344606:1000027619236,10059029504:1000031069573,08117247857:1000027745408,10038745455:1000030658103,09077134686:1000029203636,10017444781:1000030254581,10027239825:1000030434296,11115733585:1000034284345,11067327014:1000009068632,11068646075:1000033457679,11107644891:1000034153586,11096446642:1000033954424,12048647756:1000035265939,10068636235:1000031249358,10089037889:1000031627011,10059139407:1000031073305,10126627926:1000032287567,12115740863:1000036482167,10057044263:1000031025539,10079341458:1000031452367,11066348077:1000033412361,11067348429:1000005558462,11088348003:1000033809831,11028838257:1000032687774,12097349221:1000036171679,11098735048:1000033999803,12029027097:1000034878946,11047938491:1000033060432,11057340667:1000033246132,11019648992:1000032526191,12086127820:1000006517542,13066632355:1000037804196,13038743532:1000037268401,13016942663:1000001201051,12057830032:1000035445684,12098043193:1000036184474,13048949244:1000037475036,12017942652:1000034670526,12069149276:1000035662298,11099345065:1000034015299,14026144222:1000039192712,13019046006:1000005018493,13019547218:1000036910558,14027932224:1000039228899,14108025841:1000094931714,13108245608:1000038547976,14058849848:1000001048297,15016839555:1000041205996,14068838062:1000005630865,15088924360:1000042572449,15038045676:1000041610993,15067446809:1000042185041,16066626583:1000044353377,13127045113:1000038855669,14108529262:1000090735146,14096028076:1000040504816,14037634191:1000039413913,17106838526:1000047246354,17016635308:1000045575351,17096136218:1000006900657,16115926091:1000045218181,17038342630:1000045985225,17046646568:1000046145395,15066120527:1000006725718,18025533387:1000047907216,18029445423:1000047991545,17088534247:1000008592474,17027246109:1000045771055,16129232866:1000045450903,19086521310:1000008481604,18038332445:1000048156211,17016237426:1000045567616,16119348025:1000045283721,16018739015:1000001519505,17108836148:1000047282496,17127848335:1000047597161,18089247442:1000049098459,19067047837:1000050873824,19056134991:1000050670749,16076741895:1000004964223,19076240429:1000051035582,16096127352:1000044881188,17019149463:1000045626156,19047929205:1000004830792,17036528885:1000045943762,17097430004:1000047084064,16099434981:1000044954822,17056040277:1000046328177,17118936825:1000047447159,17056330267:1000046333471,20076823929:1000053229877,21026827172:1000054475872,19108547858:1000001827404,20039343208:1000002317527,17078839600:1000046748143,21048948453:1000054916069,18076432208:1000005579231,21056034010:1000055042998,22037227467:1000056847176,21108547089:1000055992447,22036717975:1000007254944,18029337884:1000047988259,22025748658:1000056621739,21115242811:1000056093872,23067426967:1000059606337,24056425337:1000087530298,23037045136:1000059025226,23119234689:1000083600457,23096443463:1000060134408,23097943052:1000060167139,24028542646:1000061040979,24025738582:1000060982576,19036940819:1000050298123,19066737872:1000001544988,19098820445:1000060740801,20068135851:1000053077486,24105833675:1000062480734,24118437426:1000001515616,21018824091:1000009412482,25068936244:1000063999409,21036326384:1000054658425,20126229268:1000054106663,25056447655:1000063767021,25046640295:1000001978662,21098941859:1000055831945,24129237674:1000062874637,26036640749:1000065549016,26028847210:1000065403313,25036943990:1000063381667,22117247884:1000058310412,23027239722:1000058833301,22087944240:1000057791056,22016044486:1000056443339,23076942684:1000059775201,28047141372:1000005050386,26095946665:1000066652255,28037736130:1000069905404,01027449626:1000005375671,01026945166:1000010704751,26088141554:1000066502913,23126128460:1000004779363,01037820675:1000085285449,23098441247:1000060177062,23059738364:1000059474459,26066048828:1000066109356,23087140210:1000059954252,27066739371:1000068276165,23065842564:1000059573966,23098445420:1000060177363,23089034124:1000059990304,27067431656:1000068291279,01096247261:1000012057274,01090085634:1000011963309,23129948418:1000060718059,01107743452:1000012286534,24016141166:1000060811026,28018147868:1000069526729,01089133331:1000011937453,01077232946:1000011710834,24048930626:1000061437961,01098641269:1000012106403,24036134069:1000061181884,01067549283:1000011514576,01069034477:1000011546321,01086746987:1000011888409,01086647911:1000011886155,24067937070:1000061792075,01097028016:1000012073842,24067438112:1000061782382,02035836481:1000013141137,29016848741:1000071684924,25107725426:1000089495667,02037231021:1000013172238,25016144919:1000062986829,29056128245:1000072290334,24088434451:1000062160639,25039946699:1000063456065,24088338614:1000062158996,25069627121:1000064016485,28056029836:1000070256491,25045945963:1000063558831,26078147082:1000005353863,03026745445:1000015165099,03028830806:1000003912742,26036528493:1000065545235,26019546240:1000065235278,29065837321:1000072467809,26087047538:1000066483536,25085935618:1000064292666,02045625683:1000013331743,02108031177:1000014500076,02037445986:1000013177801,03066135275:1000015929412,02098048270:1000014310459,02067736225:1000013767637,02068034135:1000013773425,02055942938:1000013538741,02086048658:1000014094166,27029145240:1000067561129,02096148588:1000014272006,28018537879:1000069533464,03037740577:1000015375309,27026430521:1000067503059,27107136245:1000069012852,28109245269:1000071223448,27049329844:1000067959207,28096929783:1000071000547,30066645823:1000074462229,29059441491:1000005405651,29088648453:1000072874478,29119735562:1000073424353,29036530268:1000071910239,29049338234:1000072172345,27127747259:1000069346121,27079430213:1000068513548,29018840845:1000071723156,03049140850:1000015604109,03058938830:1000015798477,28027420011:1000069700302,03068137828:1000015969871,28118944110:1000071379241,29098936694:1000073077147,29039035225:1000071969389,28067937440:1000070478993,28067646829:1000070474017,28039047502:1000069935317,28087446443:1000070823406,03126737512:1000017006681,31085941189:1000076370313,26087546224:1000066493247,28098623673:1000098826618,03096529944:1000016477987,28127943208:1000071531583,31088432404:1000076417671,28087249125:1000070819602,29019244375:1000071733734,29076330296:1000072658006,29038340679:1000071953788,27066133090:1000068262314,29097042649:1000073036329,29066646406:1000072485545,04079041470:1000018366153,29117140405:1000073373808,04037024576:1000017553243,31079038825:1000076259515,29098740420:1000073071892,30047033116:1000074097343,03127543630:1000017022928,30076236751:1000074627992,30075729126:1000074618535,28117348794:1000071351754,03088945211:1000016349864,04039049797:1000017596314,03128942172:1000004292088,05028136961:1000019574083,31018342688:1000075702198,04056845718:1000001173979,05026948683:1000019550868,05035721861:1000009191389,31086446947:1000076380197,29078133943:1000005235875,29098648877:1000005286261,30128048819:1000075523676,05117045635:1000021218187,30039034219:1000073942969,30036333746:1000073882789,30056644454:1000074278346,30037237422:1000073904237,30086931105:1000003527093,29106742837:1000073204756,31088231417:1000076413642,05099034655:1000020905757,31017828994:1000004844374,06095544205:1000023028109,31126440912:1000076713375,06045647070:1000022093222,31128949286:1000076759019,31059137487:1000076090418,31058342133:1000076074154,29028445243:1000071789888,05129138868:1000021418325,05116348383:1000021204755,31076636845:1000076213205,28087947221:1000070832192,28089725471:1000070871189,06098941892:1000023093768,06065839626:1000022488611,29096535870:1000073024146,06018444400:1000021583963,06106739399:1000023232897,07029049542:1000023960814,07116940404:1000025571791,06048424455:1000022154654,06079233771:1000022746305,07059348439:1000024550626,07097035118:1000025226507,06119246294:1000023449285,06128934047:1000023606043,07046423644:1000024287063,07068734651:1000024720083,07027141492:1000023922892,07087342268:1000025059519,07037528247:1000024114984,06117523541:1000008862911,07087244339:1000025057354,07096938971:1000025224754,08058032582:1000026689594,07078549488:1000024902126,08046835620:1000026466556,07029243047:1000023965938,07107130866:1000025408657,08048844260:1000026511606,08087632882:1000027226241,08069030085:1000026895307,08098033689:1000002220709,07106747460:1000025400858,08028824417:1000009367486,07107638894:1000025418799,08046333382:1000026454862,07117331258:1000006165147,07099546691:1000025279952,09037330636:1000028447733,08097938262:1000027409218,09037536439:1000028452259,09126947612:1000030064688,10017347212:1000030252576,09096332901:1000029539712,09038244466:1000003829306,10016325843:1000097084969,10067237612:1000031222569,09106841346:1000029728677,10027038404:1000030429433,11066141804:1000033407491,10079447663:1000031455502,11047342335:1000004815543,11066028099:1000033404682,10106942876:1000031953942,09036642987:1000028432758,11099047285:1000004926649,09046746667:1000028630274,10098038634:1000031791364,11075747561:1000033580347,11128633024:1000034504763,09088644228:1000029407623,10116044809:1000032108861,11086845670:1000033779729,11057230845:1000033243059,09077630225:1000004755032,12038926304:1000004238687,12076029901:1000035779754,11116237026:1000001546878,10078138837:1000031424603,12115643051:1000036480629,11027429590:1000032658587,11027824597:1000009498054,10057333621:1000031032493,11025641800:1000032622926,11049649837:1000033104332,11127148394:1000034479879,13028047457:1000037062292,13046634114:1000037423565,12078132025:1000035822595,12107740234:1000036353656,12107749495:1000036354368,13046635927:1000037423704,11115738552:1000034284769,13066639686:1000037804769,13077839555:1000038012266,12125448672:1000036648365,12106636336:1000036332415,13118648719:1000038718878,14058345408:1000039824608,13039335888:1000037284386,13036035840:1000037209679,14019042457:1000039067345,13088734828:1000038203047,13098832232:1000038386119,14059031660:1000039839035,13077348659:1000038003659,14078748851:1000040200875,13097242695:1000038355997,14098831216:1000040562037,15056540455:1000041974883,14129246600:1000041078564,14125849084:1000041011907,13098436876:1000038378218,14118443234:1000040894375,13117230206:1000038692728,15076435267:1000042345609,15098428973:1000008926186,16059744422:1000044238357,14116333628:1000040856741,14096644338:1000040518805,14048241647:1000039627872,15016548852:1000041200275,14115836650:1000040847541,14068334218:1000004715375,16048937601:1000044023685,16098442077:1000044930796,14067843100:1000040001386,17107638350:1000047260421,15088433545:1000042561877,15019631211:1000041265288,17018644452:1000045613319,14109341089:1000040750361,18029334818:1000047988025,18059541230:1000048570418,18125735610:1000049722781,18109439440:1000049464745,15086648218:1000042528339,14107149024:1000040707537,15057428713:1000041995404,18128542236:1000049776787,15089032544:1000042575458,17126338198:1000047566597,15077336149:1000042363625,15085838692:1000042512311,15096726888:1000006748799,15077543772:1000042368699,15067536190:1000042185893,19025643723:1000050079817,18088145654:1000049075403,16068547680:1000044392406,18119240049:1000049620332,16038728672:1000043819283,20026926603:1000052266541,19068924599:1000090071558,18125634482:1000049720729,16079043269:1000044583171,18127131569:1000049750007,16016345621:1000043395144,16086849597:1000044711918,17046730917:1000046146765,20038641140:1000052500725,20036744686:1000052458487,16088030110:1000088226454,19127517579:1000060254059,17107924167:1000094231185,16107046368:1000005162832,16095739656:1000044873843,20079730999:1000053292497,17059641212:1000046403558,16077331453:1000044549402,20129033755:1000054161174,17068635829:1000046563054,17086837471:1000046885184,19067342065:1000050879552,20076532983:1000053223902,22019239326:1000056505887,18039334808:1000048179455,20109238008:1000053830641,17117744817:1000047426371,21117442052:1000056135322,18026519574:1000081589057,22037642731:1000056857051,18088740854:1000049086544,19038534184:1000050330908,19068340759:1000050897555,17056617949:1000046339448,22105923574:1000084231725,22059349531:1000057284763,18055431759:1000048483616,23046325125:1000059203711,17117645851:1000047424804,22105928975:1000058119919,18046535134:1000048313854,20028431741:1000052298218,22117938712:1000058322878,19097041027:1000051414578,21117645727:1000056138562,19057132070:1000050691908,21076340851:1000055411744,21108648640:1000055994399,21019147670:1000054338877,23026031214:1000058808631,22118435285:1000058331036,24056846049:1000061585302,23056247726:1000059397532,24128042519:1000062852063,24076632193:1000001541377,20067636873:1000053068153,23095933971:1000060122073,20026932816:1000052267031,18115641812:1000049553132,22016729969:1000056455331,19118028107:1000093358249,23088637844:1000059981795,24125525802:1000062805891,19067843005:1000050888454,24106637098:1000062496195,20096334347:1000053592522,20097330000:1000053615773,20105734310:1000053761443,23018324822:1000102746477,20035936123:1000052439653,20129138662:1000054164062,24115537039:1000062637662,20098534254:1000053641441,21119132417:1000056165463,23096547153:1000060137012,25016321292:1000091123131,26077544819:1000066319581,21109137232:1000056003901,26065343109:1000066094401,24086532081:1000062122963,23058040843:1000059434488,26056735673:1000065938252,27088127833:1000085637481,23117237427:1000004602424,26097131391:1000066678133,22117031938:1000058305208,26069724115:1000090460332,22036627240:1000056832731,26129349203:1000067209243,24037741503:1000061217716,23089148049:1000059994186,23018927632:1000010235603,23088547039:1000059980627,26116633972:1000067002022,24049738222:1000061461618,28076437922:1000070626331,27116736484:1000069165715,27098046882:1000068857793,29037536138:1000071935588,25105843162:1000064663119,27027027925:1000067515844,27095936399:1000068809974,26069432890:1000066181678,26060181690:1000066016799,27029443616:1000067568572,28025945214:1000069669977,27096341216:1000068819483,29049134280:1000072166561,29019247099:1000071733955,28087542523:1000070825091,30057546200:1000074297915,28066642021:1000070453464,30069341833:1000074518096,31016241655:1000075660355,30079339470:1000074690187,30126825656:1000075499457,31078449546:1000076247557,30065833006:1000074444365,30115331422:1000007948757,29048740632:1000072157437,28055541460:1000070247031,24058835753:1000061624442,29068843004:1000072529943,29097736462:1000073050349,27039532013:1000067764991,29049246356:1000072170344,27078246087:1000001497374,28086743401:1000070808586,27119347403:1000069215902,29116944446:1000073369881,27107728894:1000008518645"
            - name: VAULT_MOUNTPATH
              value: postgresql/prod-fss/
            - name: KAFKA_BROKERS
              valueFrom:
                secretKeyRef:
                  key: KAFKA_BROKERS
                  name: kafka-sparke-feriepenger-nav-prod-6643edc4
            - name: KAFKA_CREDSTORE_PASSWORD
              valueFrom:
                secretKeyRef:
                  key: KAFKA_CREDSTORE_PASSWORD
                  name: kafka-sparke-feriepenger-nav-prod-6643edc4
            - name: KAFKA_KEYSTORE_PATH
              value: /var/run/secrets/nais.io/kafka/client.keystore.p12
            - name: KAFKA_TRUSTSTORE_PATH
              value: /var/run/secrets/nais.io/kafka/client.truststore.jks
      imagePullSecrets:
        - name: gpr-credentials
      initContainers:
        - name: vks-init
          image: navikt/vault-sidekick:v0.3.10-d122b16
          resources:
            requests:
              memory: "64Mi"
              cpu: "100m"
            limits:
              memory: "128Mi"
              cpu: "1000m"
          volumeMounts:
            - mountPath: /var/run/secrets/nais.io/vault
              name: vault-secrets
              subPath: subpath/var/run/secrets/nais.io/vault
          args:
            - -v=10
            - -logtostderr
            - -vault=https://vault.adeo.no
            - -one-shot
            - -save-token=/var/run/secrets/nais.io/vault/vault_token
          env:
            - name: VAULT_AUTH_METHOD
              value: kubernetes
            - name: VAULT_SIDEKICK_ROLE
              value: sparker-alt
            - name: VAULT_K8S_LOGIN_PATH
              value: auth/kubernetes/prod/fss/login
      serviceAccount: podcreator
      serviceAccountName: podcreator
      volumes:
        - name: vault-secrets
          emptyDir:
            medium: Memory
        - name: kafka-credentials
          secret:
            defaultMode: 420
            items:
              - key: KAFKA_CERTIFICATE
                path: kafka.crt
              - key: KAFKA_PRIVATE_KEY
                path: kafka.key
              - key: KAFKA_CA
                path: ca.crt
              - key: client.keystore.p12
                path: client.keystore.p12
              - key: client.truststore.jks
                path: client.truststore.jks
            secretName: kafka-sparke-feriepenger-nav-prod-6643edc4
      restartPolicy: Never
